<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-2MN7C3CEX2"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-2MN7C3CEX2');
    </script>
    <title>Stefan Đokić</title>
    <link rel="icon" type="image/x-icon" href="/images/favicon.png">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description"
        content="The personal website of Stefan Djokic, featuring information about his background, experience, and interests.">
    <meta name="keywords" content="Stefan Djokic, personal website, bio, background, experience, interests">
    <meta name="author" content="Stefan Djokic">
    <link href="https://fonts.googleapis.com/css?family=Poppins:100,200,300,400,500,600,700,800,900" rel="stylesheet">
    <link rel="stylesheet" href="/css/animate.css">
    <link rel="stylesheet" href="/css/flaticon.css">
    <link rel="stylesheet" href="/css/icomoon.css">
    <link rel="stylesheet" href="/css/style.css">
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-dark ftco_navbar ftco-navbar-light site-navbar-target" id="ftco-navbar">
        <div class="container">
          <a class="navbar-brand" href="/">Stefan Đokić</a>
          <button class="navbar-toggler js-fh5co-nav-toggle fh5co-nav-toggle" type="button" data-toggle="collapse"
            data-target="#ftco-nav" aria-controls="ftco-nav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="oi oi-menu"></span> Menu
          </button>
          <div class="collapse navbar-collapse" id="ftco-nav">
            <ul class="navbar-nav nav ml-auto">
              <li class="nav-item"><a href="/" class="nav-link"><span>Home</span></a></li>
              <li class="nav-item" data-toggle="collapse" data-target="#ftco-nav"><a href="/blog.html"
                  class="nav-link"><span>Blog</span></a></li>
    
            </ul>
          </div>
        </div>
      </nav>


    <section class="ftco-about img ftco-section ftco-no-pb" id="social-proof" style="margin-top: 50px;">
        <div class="container">
            <div class="row justify-content-center pb-5">
                <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 heading-section text-center ">
                    <h2 style="margin-top: 50px">#4 Stefan's Newsletter</h2>
                    <h2 style="color: #ffbd39">GitHub Webhook with C#</h2>
                    <h6>March 06 2023</h6>
                </div>
            </div>
            <div class="container row d-flex">
                <div class="col-sm-12 col-md-12 col-lg-12 pb-5">
                    <h3 class="text-center mb-5" style="color: #ffbd39">The background</h3>
                    <h5 style="text-align: justify;">
                        A <b>Webhook</b> is a mechanism that allows a web application to send real-time notifications or
                        data to another web application.
                    </h5> <br>
                    <h5 style="text-align: justify;">
                        It is essentially a way for two different applications to communicate with each other in "real
                        time" rather than relying on periodic polling or manual data transfer.
                    </h5> <br>
                    <h5 style="text-align: justify;">
                        An example of a simple implementation of a C# Webhook receiver for Github will be shown below.
                    </h5> <br>
                    <h5 style="text-align: justify;">
                        ** In this edition of the newsletter, there will be no mention of the implementation of the
                        webhook mechanism (sender & receiver) due to the volume of the problem, which is not adequate
                        for the newsletter.</h5> <br>
                    <h3 class="text-center mb-5 mt-5" style="color: #ffbd39;margin-top: -40px;">C# Webhook receiver</h3>
                    <h5 style="text-align: justify;">A webhook receiver for an event that happened on Github or any
                        other service can be represented in the simplest way as an <b>HttpPost API endpoint</b> in a C#
                        controller.</h5>
                    <h5 style="text-align: justify;"><b>• Create an action in C# Controller
                        </b></h5>
                    <h5 style="text-align: justify;">You need to create C # API Controller with GitHubWebhookController
                        name. This is a controller to serve for all Events that happen within Github repository.</h5>
                    <h5 style="text-align: justify;">After that, you need to add an endpoint Pushed for the "push" event
                        on github, which will practically serve as a callback event. </h5>
                    <img src="/images/blog/newsletter4/GitHubWebhookController.png"
                        style="margin-top: 10px; margin-bottom: 10px; width: 100%;">
                    <h5 style="text-align: justify;">
                        This method must be HttpPost.
                    </h5><br>
                    <h5 style="text-align: justify;">Since I currently don't know what the GitHub payload looks like,
                        ie. object/JSON that GitHub sends during a specific event, I will state that the object that the
                        method receives as a parameter is type dynamic.
                    </h5><br>
                    <h5 style="text-align: justify;"><b>• Run the application
                        </b></h5><br>
                    <h5 style="text-align: justify;">When you start the API project, through Swagger you can see
                        Endpoint there is and that everything is fine for now.</h5>
                    <br>
                    <img src="/images/blog/newsletter4/Swagger - API Project Webhook.png"
                        style="margin-top: 10px; margin-bottom: 10px; width: 100%;">
                    <h3 class="text-center mb-5 mt-5" style="color: #ffbd39;margin-top: -40px;">Create Webhook instance
                        on GitHub</h3>

                    <h5 style="text-align: justify;">

                        Within the GitHub repository for which you want to receive events, you need to generate a
                        Webhook instance. In the repository settings, you should select the Webhooks link from the left
                        menu. And click on the Add webhook button. You should see the following form:
                    </h5>
                    <br>
                    <img src="/images/blog/newsletter4/GitHub - Add webhook form.png"
                        style="margin-top: 10px; margin-bottom: 10px; width: 100%;">
                    <h5 style="text-align: justify;">The most important field to fill in is of course the
                        <b>PayloadUrl</b>.
                    </h5><br>
                    <h5 style="text-align: justify;"><b>This field represents the endpoint of our application that
                            Github will call the moment a push event occurs on the selected repository.
                        </b>
                    </h5><br>
                    <h5 style="text-align: justify;"><b>Content type:</b> You can choose application/json
                    </h5><br>
                    <h5 style="text-align: justify;"><b>Secret:</b> You can generate via some online generator. This
                        secret is used to verify that the payload was actually sent by Github and not by a malicious
                        third party pretending to be Github. For demo purposes I will leave it blank, but <span
                            style="color: red"> do not do this on production</span>.
                    </h5><br>
                    <h5 style="text-align: justify;">The most important field to fill in is of course the PayloadUrl.
                    </h5><br>
                    <h5 style="text-align: justify;">Okay, now, what will happen if you put the localhost link
                        <b><i>(http://localhost:7030/api/GithubWebhook/push)</i></b> like a Payload URL?
                    </h5><br>
                    <h5 style="text-align: justify;">Nothing.
                    </h5><br>
                    <h5 style="text-align: justify;">GitHub doesn't know that your localhost exists somewhere on your
                        computer. It is necessary that the application is deployed somewhere, say Azure.
                    </h5><br>
                    <h5 style="text-align: justify;">But for testing and debugging, <b>ngrok</b> can help you.
                    </h5><br>
                    <h5 style="text-align: justify;"><b>What is ngrok?
                        </b>.
                    </h5><br>
                    <h5 style="text-align: justify;">Ngrok is a software tool that creates a secure tunnel between a
                        local machine and the public internet, allowing developers to expose a web server running on
                        their local machine to the internet.
                    </h5><br>
                    <h5 style="text-align: justify;"><b>Ngrok setup</b>.
                    </h5><br>
                    <h5 style="text-align: justify;">• Download from: <a href="https://ngrok.com/"
                            target="_blank">ngrok</a>
                    </h5>
                    <h5 style="text-align: justify;">• Install it and run it.
                    </h5>
                    <h5 style="text-align: justify;">• Execute the following command: <b>ngrok http port</b>
                    </h5><br>
                    <h5 style="text-align: justify;"><i>* Port should be your port which you can see when you start the
                            application.</i>
                    </h5>
                    <h5 style="text-align: justify;"><i>* You should <b> disable https protocol</b> for the application
                            by replacing https urls with http in<b> launchSettings.json</b>.
                        </i>
                    </h5><br>
                    <h5 style="text-align: justify;">Now you will see in CMD the url that is online and to which the
                        localhost url is mapped.
                    </h5><br>
                    <h5 style="text-align: justify;">If you visit the url from the "forwarding" part, you will see
                        exactly the same result as for localhost. Of course, the advantage of this is that the debugger
                        is active.
                    </h5>
                    <img src="/images/blog/newsletter4/ngrok CMD.png"
                        style="margin-top: 10px; margin-bottom: 10px; width: 100%;">
                    <h5 style="text-align: justify;">
                        The next thing is to put that ngrok url together with the API endpoint in the Payload Url field:
                        <br> <b><i>https://9739-178-220-34-243.eu.ngrok.io/api/GitHubWebhook/pushed</i></b>
                    </h5>
                    <h3 class="text-center mb-5 mt-5" style="color: #ffbd39;margin-top: -40px;">Testing</h3>
                    <h5 style="text-align: justify;">

                        1. Run the application</h5>
                    <h5 style="text-align: justify;">

                        2. Put a breakpoint in the Pushed method
                    </h5>
                    <h5 style="text-align: justify;">

                        3. Go to the repository and make some changes
                    </h5>

                    <img src="/images/blog/newsletter4/Commit changes - Github repo.png"
                        style="margin-top: 10px; margin-bottom: 10px; width: 100%;">
                    <h5 style="text-align: justify;">


                        4. Wait for a couple of seconds, and call should hit the debugger
                    </h5>
                    <h5 style="text-align: justify;">

                        5. You can see parameter payload is full of data

                    </h5>
                    <img src="/images/blog/newsletter4/Debugger.png"
                        style="margin-top: 10px; margin-bottom: 10px; width: 100%;">
                    <h3 class="text-center mb-5 mt-5" style="color: #ffbd39;margin-top: -40px;">What Next?</h3>
                    <h5 style="text-align: justify;">
                        On this very simple example, I have shown how a webhook receiver for Github can be implemented.
                    </h5>
                    <br>
                    <h5 style="text-align: justify;">
                        In this way, any service that supports WebHooks works. With the fact that there is a difference
                        from service to service in the payload that is sent, so based on what you need, you will create
                        a class with properties instead of receiving a dynamic type of payload.
                    </h5>
                    <br>

                    <h5 style="text-align: justify;">
                        Also, this can be implemented with Azure Functions, so be sure you do a research on that topic.
                    </h5>
                    <br>

                    <h5 style="text-align: justify;">
                        For GitHub payload for each webhook you can find at: <a
                            href="https://docs.github.com/en/webhooks-and-events/webhooks/webhook-events-and-payloads"
                            target="_blank"> Github Webhook Documentation</a>
                    </h5>
                    <br>
                    <h5 style="text-align: justify;">

                        That's all from me for today.
                    </h5>
                    <br>

                    <h5 style="text-align: justify;">
                        Make a coffee and check out source code directly on my <a
                            href="https://github.com/StefanTheCode/Newsletter" target="_blank"> GitHub repository</a>.
                    </h5>
                    <br>
                    <h3 class="text-center"><b>Dream <span style="font-size: 50px;">big!</span></b></h3>
                    <div class="row" style="margin-top: 50px">
                        <div class="col-md-3"></div>
                        <div class="col-md-6 text-center">
                            <h5 style="text-align: center; ">
                                Join the 2200+ engineers who get tips like this every Monday straight to their inbox.
                            </h5>
                            <script async src="https://eocampaign1.com/form/33e483be-a0b1-11ed-b1bd-9b9d338510f2.js"
                                data-form="33e483be-a0b1-11ed-b1bd-9b9d338510f2"></script>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </section>
  
    <script src="/js/jquery.min.js"></script>
    <script src="/js/jquery.waypoints.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/main.js"></script>

</body>

</html>